(()=>{"use strict";class e{constructor(e,t){this._form=t,this._settings=e,this._button=this._form.querySelector(this._settings.buttonSaveSelector),this._inputs=Array.from(this._form.querySelectorAll(this._settings.inputSelector))}_submitForm(e){e.preventDefault()}_showInputError(e){const{inputErrorClass:t}=this._settings;e.classList.add(t),this._errorContainer.classList.add(),this._errorContainer.textContent=e.validationMessage}_hidenInvalidInput(e){const{inputErrorClass:t}=this._settings;e.classList.remove(t),this._errorContainer.classList.remove(),this._errorContainer.textContent=""}_toggleButton(){const{inactiveButtonClass:e}=this._settings;this._form.checkValidity()?(this._button.classList.remove(e),this._button.removeAttribute("disabled")):this.disableButton()}_validateInput(e){this._errorContainer=this._form.querySelector(`#error-${e.id}`),e.validity.valid?this._hidenInvalidInput(e,this._errorContainer):this._showInputError(e,this._errorContainer),this._toggleButton()}disableButton=()=>{const{inactiveButtonClass:e}=this._settings;this._button.classList.add(e),this._button.disabled=!0};enableValidation(){this._form.addEventListener("submit",this._submitForm),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._validateInput(e)}))})),this._toggleButton()}}const t={formSelector:".popup__name",inputSelector:".popup__item",buttonSaveSelector:".popup__save",errorVisibleClass:"popup__input-error_visible",errorSelector:".popup__input-error",inputErrorClass:"popup__item_type_error",inactiveButtonClass:"popup__save_disabled"},s=document.querySelector(".popup_type_edit"),n=document.querySelector(".popup_type_add-card"),r=s.querySelector(".popup__name"),i=n.querySelector(".popup__name"),o=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-button"),l=document.querySelector(".popup__item_type_name"),p=document.querySelector(".popup__item_type_about-name"),_=new e(t,r),c=new e(t,i);class d{constructor(e,t,s){this._cardData=e,this._template=document.querySelector(t).content.querySelector(".elements__list"),this._handlImageClick=s}_likeClickHandler=()=>{this._cardLike.classList.toggle("elements__like_black")};_deleteHandler=()=>{this._cardElement.remove(),this._cardElement=null};_setEventListener(){this._deleteButton.addEventListener("click",this._deleteHandler),this._cardLike.addEventListener("click",this._likeClickHandler),this._cardImage.addEventListener("click",this._handlImageClick)}createCard(){return this._cardElement=this._template.cloneNode(!0),this._cardImage=this._cardElement.querySelector(".elements__photo"),this._cardText=this._cardElement.querySelector(".elements__text"),this._deleteButton=this._cardElement.querySelector(".elements__delete-button"),this._cardLike=this._cardElement.querySelector(".elements__like"),this._cardText.textContent=this._cardData.name,this._cardImage.src=`${this._cardData.link}`,this._cardImage.alt=`${this._cardData.name}`,this._setEventListener(),this._cardElement}}class u{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){const e=this._popup.querySelector(".popup__close");this._popup.addEventListener("click",(t=>{(t.target.classList.contains("popup_opened")||t.target===e)&&this.close(this._popup)}))}}class h extends u{constructor(e,t){super(e),this._form=this._popup.querySelector(".popup__name"),this._inputList=[...this._form.querySelectorAll(".popup__item")],this._handleSubmit=t}_getInputValue(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(()=>{this._handleSubmit(this._getInputValue())}))}close(){super.close(),this._form.reset()}}function m(e){const t=new d(s=e,".card",(()=>{y.open(s.name,s.link)})).createCard();var s;v.addItem(t)}o.addEventListener("click",(()=>function(){const e=g.getUserInfo();l.value=e.title.trim(),p.value=e.job.trim(),b.open()}())),a.addEventListener("click",(()=>{c.disableButton(),E.open()})),_.enableValidation(),c.enableValidation();const v=new class{constructor({items:e,renderer:t},s){this._container=document.querySelector(s),this._initialCards=e,this._renderer=t}addItem(e){this._container.prepend(e)}renderItems(){this._initialCards.forEach((e=>this._renderer(e)))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:m},".elements__lists"),y=new class extends u{constructor(e){super(e),this._title=this._popup.querySelector(".popup__place-title"),this._image=this._popup.querySelector(".popup__image-link")}open(e,t){this._image.src=t,this._title.textContent=e,this._image.alt=e,super.open()}}(".popup_type_image"),E=new h(".popup_type_add-card",(function(e){m(e),E.close()})),b=new h(".popup_type_edit",(e=>{const{popup__input_name:t,popup__input_about_name:s}=e;g.setUserInfo(t,s),b.close()})),g=new class{constructor({profileNameSelector:e,profileJobSelector:t}){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t)}getUserInfo(){return{title:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}({profileNameSelector:".profile__title",profileJobSelector:".profile__text"});v.renderItems(),y.setEventListeners(),E.setEventListeners(),b.setEventListeners()})();